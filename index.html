<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>TOS Order Generator</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 30px; background: #fff; color: #000; }
    h2 { margin-top: 20px; }
    label { display: block; margin-top: 10px; }
    input, select { padding: 6px; margin-top: 4px; width: 250px; }
    button { margin-top: 15px; padding: 8px 16px; cursor: pointer; }
    textarea { width: 100%; height: 80px; margin-top: 10px; font-family: monospace; }
  </style>
</head>
<body>

  <h1>Thinkorswim Order Generator</h1>

  <label>Trade Type
    <select id="tradeType">
      <option value="Iron Fly">Iron Fly</option>
      <option value="Bullish FF IC">Bullish FF IC</option>
      <option value="Bearish FF IC">Bearish FF IC</option>
      <option value="Regular Iron Condor">Regular Iron Condor</option>
    </select>
  </label>

  <label>Anchor Strike <input type="number" id="anchorStrike" placeholder="6700"></label>
  
  <label>Width
    <select id="width">
      <option value="5">5</option>
      <option value="20">20</option>
      <option value="40">40</option>
      <option value="50">50</option>
      <option value="100">100</option>
      <option value="custom">Custom</option>
    </select>
  </label>
  <label id="customWidthLabel" style="display:none;">Custom Width <input type="number" id="customWidth"></label>

  <label>Ticker <input type="text" id="ticker" value="SPX"></label>
  <label>Date <input type="date" id="tradeDate"></label>
  <label>Action 
    <select id="action">
      <option value="SELL">SELL</option>
      <option value="BUY">BUY</option>
    </select>
  </label>
  <label>Quantity <input type="number" id="quantity" value="-1"></label>
  <label>Multiplier <input type="number" id="multiplier" value="100"></label>
  <label>Order Price <input type="text" id="orderPrice" value="50.00"></label>
  <label>Price Type 
    <select id="priceType">
      <option value="LMT">LMT</option>
      <option value="MKT">MKT</option>
    </select>
  </label>
  <label>Year Override <input type="number" id="yearOverride" value="2025"></label>
  <label><input type="checkbox" id="weeklyTag" checked> Include (Weeklys)</label>

  <button onclick="generateOrder()">Convert & Copy</button>

  <h2>Opening Order</h2>
  <textarea id="openingOrder" readonly></textarea>

  <h2>Closing Order</h2>
  <textarea id="closingOrder" readonly></textarea>
  <button onclick="copyClosing()">Copy Closing Order</button>

  <script>
    // Show custom width input if selected
    document.getElementById("width").addEventListener("change", function() {
      document.getElementById("customWidthLabel").style.display = 
        this.value === "custom" ? "block" : "none";
    });

    function formatDate(inputDate) {
      const date = new Date(inputDate);
      const day = date.toLocaleString('en-US', { day: '2-digit' });
      const month = date.toLocaleString('en-US', { month: 'short' }).toUpperCase();
      const year = date.getFullYear().toString().slice(-2);
      return `${day} ${month} ${year}`;
    }

    function generateOrder() {
      const tradeType = document.getElementById("tradeType").value;
      const anchor = parseInt(document.getElementById("anchorStrike").value);
      let width = document.getElementById("width").value;
      if (width === "custom") width = parseInt(document.getElementById("customWidth").value);
      else width = parseInt(width);

      const ticker = document.getElementById("ticker").value.toUpperCase();
      const tradeDate = document.getElementById("tradeDate").value || new Date().toISOString().split('T')[0];
      const formattedDate = formatDate(tradeDate);

      const action = document.getElementById("action").value;
      const quantity = document.getElementById("quantity").value;
      const multiplier = document.getElementById("multiplier").value;
      const orderPrice = document.getElementById("orderPrice").value;
      const priceType = document.getElementById("priceType").value;
      const yearOverride = document.getElementById("yearOverride").value;
      const weeklyTag = document.getElementById("weeklyTag").checked ? "(Weeklys)" : "";

      let openingOrder = "";
      let closingOrder = "";

      if (tradeType === "Iron Fly") {
        openingOrder = `${action} ${quantity} 1/-1/1/-1 CUSTOM ${ticker} ${multiplier} ${weeklyTag} ${formattedDate} ${anchor}/${anchor+width}/${anchor}/${anchor-width} CALL/CALL/PUT/PUT @${orderPrice} ${priceType}`;
      } else if (tradeType === "Bullish FF IC") {
        openingOrder = `BUY +1 1/-1/-1/1 CUSTOM ${ticker} ${multiplier} ${weeklyTag} ${formattedDate} ${anchor}/${anchor+width}/${anchor}/${anchor-width} CALL/CALL/PUT/PUT @${orderPrice} ${priceType}`;
      } else if (tradeType === "Bearish FF IC") {
        openingOrder = `SELL -1 1/-1/-1/1 CUSTOM ${ticker} ${multiplier} ${weeklyTag} ${formattedDate} ${anchor}/${anchor+width}/${anchor}/${anchor-width} CALL/CALL/PUT/PUT @${orderPrice} ${priceType}`;
      } else if (tradeType === "Regular Iron Condor") {
        openingOrder = `SELL -1 IRON CONDOR ${ticker} ${multiplier} ${weeklyTag} ${formattedDate} ${anchor+25}/${anchor+width}/${anchor-25}/${anchor-width} CALL/PUT @${orderPrice} ${priceType}`;
      }

      // Flip for closing order
      closingOrder = openingOrder.replace("SELL -1", "BUY +1").replace("BUY +1", "SELL -1");

      document.getElementById("openingOrder").value = openingOrder;
      document.getElementById("closingOrder").value = closingOrder;

      // Auto copy opening order
      navigator.clipboard.writeText(openingOrder);
      alert("Opening order copied to clipboard!");
    }

    function copyClosing() {
      const closing = document.getElementById("closingOrder").value;
      navigator.clipboard.writeText(closing);
      alert("Closing order copied to clipboard!");
    }
  </script>

</body>
</html>